import pathlib

default_ports = {80, 443, 8000, 8080, 8443}  # 默认使用
small_ports = {80,81,82,83,84,85,86,87,88,89,90,91,92,98,99,443,800,801,808,880,888,889,1000,1010,1080,1081,1082,1158,1863,1980,2018,2019,2100,3000,3128,3505,5555,6080,6677,7000,7001,7002,7003,7005,7007,7070,7080,7200,7777,7890,8000,8001,8002,8003,8004,8006,8008,8009,8010,8011,8012,8014,8016,8020,8028,8042,8053,8060,8069,8070,8080,8081,8082,8083,8084,8085,8086,8087,8088,8089,8090,8091,8092,8093,8094,8095,8096,8097,8098,8099,8100,8101,8108,8118,8123,8161,8172,8180,8181,8200,8222,8243,8251,8280,8281,8300,8333,8360,8443,8484,8500,8800,8834,8879,8880,8881,8888,8899,8983,8989,9000,9001,9002,9043,9060,9080,9081,9082,9085,9090,9091,9092,9200,9443,9800,9981,9999,10000,10001,10002,10003,12443,15672,16080,18080,18082,18091,18092,20720,28017,38501,38888}
medium_ports = {70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,121,300,443,444,591,593,666,801,802,803,804,805,806,807,808,809,810,832,878,880,881,882,883,884,885,886,887,888,889,900,901,902,903,904,905,906,907,908,909,910,981,1010,1024,1080,1081,1082,1083,1084,1085,1086,1087,1088,1089,1090,1099,1311,1515,1723,1883,2020,2082,2087,2095,2096,2480,3000,3128,3333,3490,4000,4243,4430,4431,4432,4433,4434,4435,4436,4437,4438,4439,4443,4567,4711,4712,4782,4993,4995,5000,5001,5002,5003,5004,5005,5006,5007,5008,5009,5104,5108,5222,5269,5800,5985,6000,6001,6002,6003,6004,6005,6006,6007,6008,6009,6070,6071,6072,6073,6074,6075,6076,6077,6078,6079,6080,6081,6082,6083,6084,6085,6086,6087,6088,6089,6090,6091,6092,6093,6094,6095,6096,6097,6098,6099,6440,6441,6442,6443,6444,6445,6446,6447,6448,6449,6543,6600,6601,6602,6603,6604,6605,6606,6607,6608,6609,7000,7001,7002,7003,7004,7021,7071,7144,7181,7210,7396,7443,7474,7510,7547,7579,7580,7700,7770,7777,7778,7787,7800,7801,7879,7902,8000,8001,8002,8003,8004,8005,8006,8007,8008,8009,8010,8011,8012,8013,8014,8015,8016,8017,8018,8019,8020,8021,8022,8023,8024,8025,8026,8027,8028,8029,8030,8031,8032,8033,8034,8035,8036,8037,8038,8039,8040,8041,8042,8043,8044,8045,8046,8047,8048,8049,8050,8051,8052,8053,8054,8055,8056,8057,8058,8059,8060,8061,8062,8063,8064,8065,8066,8067,8068,8069,8070,8071,8072,8073,8074,8075,8076,8077,8078,8079,8080,8081,8082,8083,8084,8085,8086,8087,8088,8089,8090,8091,8092,8093,8094,8095,8096,8097,8098,8099,8100,8101,8102,8103,8104,8105,8106,8107,8108,8109,8112,8123,8126,8140,8161,8172,8180,8181,8182,8183,8184,8185,8186,8187,8188,8189,8190,8222,8243,8280,8281,8443,8444,8500,8513,8800,8801,8802,8803,8804,8805,8806,8807,8808,8809,8810,8834,8849,8870,8871,8872,8873,8874,8875,8876,8877,8878,8879,8880,8881,8882,8883,8884,8885,8886,8887,8888,8889,8890,8891,8892,8893,8894,8895,8896,8897,8898,8899,8983,8989,9000,9001,9002,9003,9004,9005,9006,9007,9008,9009,9010,9011,9012,9013,9014,9015,9016,9017,9018,9019,9020,9021,9022,9023,9024,9025,9026,9027,9028,9029,9030,9031,9032,9033,9034,9035,9036,9037,9038,9039,9043,9060,9080,9081,9082,9083,9084,9085,9086,9087,9088,9089,9090,9091,9092,9093,9094,9095,9096,9097,9098,9099,9100,9101,9102,9103,9104,9105,9106,9107,9108,9109,9110,9119,9180,9181,9200,9391,9443,9495,9600,9800,9809,9810,9811,9812,9813,9814,9815,9855,9980,9981,9982,9983,9984,9985,9986,9987,9988,9989,9990,9991,9992,9993,9994,9995,9996,9997,9998,9999,10000,10001,10002,10003,10004,10080,10081,10082,10083,10084,10085,10086,10087,10088,10089,10090,10443,12345,12443,14000,14001,14002,14003,14004,14005,14900,14901,14902,14903,14904,14905,14906,14907,14908,14909,16080,18081,18091,18092,20720,21500,21501,21502,21503,21504,21505,21506,21507,21508,21509,21510,21511,21512,21513,21514,21515,21516,21517,21518,21519,21520,21521,21522,21523,21524,21525,21526,21527,21528,21529,21530,28017,38501,38888,43201,50070,60001,60002}
large_ports =  {20,25,30,60,65,66,68,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,114,121,122,132,133,171,180,188,198,200,206,208,211,223,235,268,270,280,299,300,302,308,309,321,333,381,403,421,423,436,442,443,444,447,511,517,522,560,586,591,593,602,610,666,688,701,708,733,770,778,800,801,802,803,804,805,806,807,808,809,810,811,812,832,843,860,866,873,877,878,880,881,882,883,884,885,886,887,888,889,900,901,902,903,904,905,906,907,908,909,910,911,916,925,955,956,968,981,983,999,1000,1001,1002,1003,1004,1005,1006,1007,1008,1009,1010,1016,1020,1024,1025,1039,1042,1046,1080,1081,1082,1083,1084,1085,1086,1087,1088,1089,1090,1099,1100,1104,1107,1108,1122,1123,1128,1158,1180,1182,1200,1212,1213,1234,1300,1301,1311,1313,1356,1389,1433,1443,1445,1500,1515,1550,1600,1603,1666,1680,1700,1722,1723,1790,1800,1818,1863,1883,1900,1933,1949,1979,1980,1982,1984,1988,1999,2000,2001,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2018,2019,2020,2030,2046,2051,2060,2070,2080,2081,2082,2083,2084,2085,2086,2087,2088,2089,2093,2095,2096,2100,2101,2102,2103,2104,2105,2106,2107,2108,2109,2110,2125,2168,2181,2222,2233,2261,2301,2340,2348,2375,2382,2480,2490,2517,2521,2525,2585,2663,2800,2801,2802,2803,2804,2805,2806,2807,2808,2809,2810,2811,2812,2813,2814,2815,2816,2817,2818,2819,2880,2881,2882,2883,2884,2885,2886,2887,2888,2889,2901,3000,3001,3002,3003,3004,3005,3006,3007,3008,3009,3010,3011,3012,3013,3014,3015,3016,3017,3018,3019,3030,3033,3050,3080,3094,3128,3133,3216,3220,3306,3312,3333,3377,3380,3398,3437,3443,3456,3465,3490,3503,3505,3535,3580,3588,3600,3606,3618,3668,3680,3690,3721,3737,3880,3938,4000,4001,4005,4016,4023,4040,4180,4237,4242,4243,4300,4321,4380,4389,4430,4431,4432,4433,4434,4435,4436,4437,4438,4439,4440,4443,4453,4455,4480,4497,4503,4567,4569,4570,4711,4712,4782,4848,4850,4993,4995,5000,5001,5002,5003,5004,5005,5006,5007,5008,5009,5010,5013,5050,5080,5081,5098,5100,5104,5108,5118,5151,5155,5156,5200,5201,5203,5222,5225,5233,5255,5256,5269,5280,5501,5544,5552,5555,5560,5561,5566,5600,5601,5632,5644,5655,5656,5678,5757,5780,5800,5811,5881,5887,5888,5898,5902,5966,5985,6000,6001,6002,6003,6004,6005,6006,6007,6008,6009,6010,6011,6020,6060,6070,6071,6072,6073,6074,6075,6076,6077,6078,6079,6080,6081,6082,6083,6084,6085,6086,6087,6088,6089,6090,6091,6092,6093,6094,6095,6096,6097,6098,6099,6100,6101,6118,6167,6170,6180,6198,6226,6259,6286,6365,6372,6379,6388,6440,6441,6442,6443,6444,6445,6446,6447,6448,6449,6510,6543,6546,6565,6587,6600,6601,6602,6603,6604,6605,6606,6607,6608,6609,6611,6664,6666,6677,6680,6688,6699,6778,6789,6800,6801,6842,6868,6869,6879,6886,6887,6888,6889,6890,6920,6969,6988,7000,7001,7002,7003,7004,7005,7006,7007,7008,7009,7010,7011,7012,7017,7018,7020,7021,7022,7023,7028,7031,7041,7044,7048,7050,7055,7060,7070,7071,7072,7080,7081,7082,7083,7084,7086,7088,7090,7093,7094,7100,7101,7102,7108,7111,7117,7123,7129,7140,7144,7171,7180,7181,7200,7201,7202,7210,7215,7272,7273,7280,7288,7300,7321,7330,7380,7396,7443,7474,7500,7501,7510,7547,7567,7579,7580,7700,7702,7703,7709,7711,7713,7742,7751,7770,7776,7777,7778,7787,7788,7789,7791,7799,7800,7801,7856,7879,7888,7890,7896,7899,7900,7901,7902,7903,7909,7915,7921,7925,7942,7943,7979,7995,7999,8000,8001,8002,8003,8004,8005,8006,8007,8008,8009,8010,8011,8012,8013,8014,8015,8016,8017,8018,8019,8020,8021,8022,8023,8024,8025,8026,8027,8028,8029,8030,8031,8032,8033,8034,8035,8036,8037,8038,8039,8040,8041,8042,8043,8044,8045,8046,8047,8048,8049,8050,8051,8052,8053,8054,8055,8056,8057,8058,8059,8060,8061,8062,8063,8064,8065,8066,8067,8068,8069,8070,8071,8072,8073,8074,8075,8076,8077,8078,8079,8080,8081,8082,8083,8084,8085,8086,8087,8088,8089,8090,8091,8092,8093,8094,8095,8096,8097,8098,8099,8100,8101,8102,8103,8104,8105,8106,8107,8108,8109,8110,8111,8112,8118,8119,8122,8123,8126,8130,8133,8136,8140,8144,8153,8161,8168,8172,8176,8180,8181,8182,8183,8184,8185,8186,8187,8188,8189,8190,8191,8192,8193,8196,8197,8200,8201,8202,8213,8220,8222,8232,8243,8250,8251,8260,8280,8281,8282,8283,8288,8298,8300,8308,8322,8333,8341,8343,8360,8380,8381,8382,8383,8384,8390,8391,8399,8400,8401,8402,8403,8443,8444,8445,8465,8477,8480,8481,8484,8488,8499,8500,8512,8513,8548,8567,8580,8582,8585,8600,8601,8610,8649,8660,8666,8680,8681,8684,8686,8688,8700,8710,8720,8735,8777,8780,8781,8787,8788,8799,8800,8801,8802,8803,8804,8805,8806,8807,8808,8809,8810,8813,8818,8820,8822,8828,8834,8839,8844,8848,8849,8860,8861,8864,8866,8868,8870,8871,8872,8873,8874,8875,8876,8877,8878,8879,8880,8881,8882,8883,8884,8885,8886,8887,8888,8889,8890,8891,8892,8893,8894,8895,8896,8897,8898,8899,8900,8901,8902,8905,8910,8912,8913,8955,8956,8972,8974,8980,8983,8987,8988,8989,8990,8991,8992,8997,8999,9000,9001,9002,9003,9004,9005,9006,9007,9008,9009,9010,9011,9012,9013,9014,9015,9016,9017,9018,9019,9020,9021,9022,9023,9024,9025,9026,9027,9028,9029,9030,9031,9032,9033,9034,9035,9036,9037,9038,9039,9043,9050,9053,9060,9061,9068,9070,9080,9081,9082,9083,9084,9085,9086,9087,9088,9089,9090,9091,9092,9093,9094,9095,9096,9097,9098,9099,9100,9101,9102,9103,9104,9105,9106,9107,9108,9109,9110,9111,9112,9113,9119,9131,9168,9180,9181,9182,9183,9184,9185,9186,9187,9188,9189,9190,9191,9192,9198,9200,9201,9208,9212,9218,9224,9231,9300,9301,9302,9333,9391,9437,9443,9494,9495,9500,9504,9507,9512,9517,9527,9541,9542,9595,9600,9666,9696,9704,9718,9800,9801,9802,9803,9804,9805,9806,9807,9808,9809,9810,9811,9812,9813,9814,9815,9836,9845,9855,9876,9888,9889,9898,9900,9901,9908,9909,9910,9912,9914,9918,9919,9922,9977,9980,9981,9982,9983,9984,9985,9986,9987,9988,9989,9990,9991,9992,9993,9994,9995,9996,9997,9998,9999,10000,10001,10002,10003,10004,10005,10007,10009,10010,10016,10017,10021,10024,10025,10038,10040,10050,10051,10056,10057,10060,10066,10068,10069,10070,10078,10080,10081,10082,10083,10084,10085,10086,10087,10088,10089,10090,10098,10099,10101,10111,10118,10152,10154,10200,10333,10443,10777,11000,11001,11080,11158,11180,11211,11212,11324,11347,11362,11366,11372,11381,11660,12001,12315,12333,12345,12443,12881,13333,13382,13988,14000,14001,14002,14003,14004,14005,14007,14338,14549,14900,14901,14902,14903,14904,14905,14906,14907,14908,14909,15000,15004,15018,15080,15400,15580,15672,15693,15698,15801,15888,16080,16580,16788,16929,17000,17003,17071,17095,17173,17448,17777,18000,18001,18002,18008,18060,18080,18081,18082,18083,18084,18085,18086,18087,18088,18089,18090,18091,18092,18103,18181,18264,18765,18801,18802,18803,18804,18805,18806,18807,18808,18809,18880,18881,18882,18883,18884,18885,18886,18887,18888,18889,19000,19010,19045,19080,19088,19101,19244,19994,20000,20001,20021,20022,20033,20046,20052,20140,20142,20151,20153,20165,20200,20202,20411,20658,20677,20678,20680,20683,20702,20720,20802,20806,20808,20992,21080,21088,21188,21245,21500,21501,21502,21503,21504,21505,21506,21507,21508,21509,21510,21511,21512,21513,21514,21515,21516,21517,21518,21519,21520,21521,21522,21523,21524,21525,21526,21527,21528,21529,21530,21900,22080,22222,22228,22343,22480,22580,23352,23380,23454,23458,25006,25024,27000,27017,27779,28017,28080,28099,28214,28280,28780,29798,30000,30001,30015,30025,30030,30058,30082,30088,30551,31000,31082,31188,31945,32766,34440,34899,37006,38000,38080,38086,38443,38501,38517,38888,40000,40001,40069,40080,40310,41474,41516,42424,43201,43651,44401,44445,45149,45177,45692,47078,47088,47583,48080,49705,49960,50000,50030,50045,50060,50070,50075,50080,50090,50100,50240,51106,55070,55351,55352,55858,56688,57880,58000,58031,58060,58080,58083,58090,58124,58898,59009,59093,59777,59999,60001,60002,60010,60022,60080,60101,60465,61081,61999,65000,65001,65055,65486,65493,65533} # 可以在这里面添加端口
ports = {'default': default_ports, 'small': small_ports,
         'medium': medium_ports, 'large': large_ports}

# 忽略状态码配置
ignore_status_code = [400,502,429,500,401,501,402,406,503,403,404,405,301,302,307]
# SSL配置
verify_ssl = False
# 重定向配置
allow_redirects = False
# 扫描线程
threads = 900
# 延迟配置
timeout = 15
realpath = pathlib.Path(__file__).parent
result_save_path = realpath.joinpath('results')
